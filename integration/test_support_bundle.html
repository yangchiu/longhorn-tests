<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.0">
<title>tests.test_support_bundle API documentation</title>
<meta name="description" content="">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>tests.test_support_bundle</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="tests.test_support_bundle.check_bundled_nodes_matches"><code class="name flex">
<span>def <span class="ident">check_bundled_nodes_matches</span></span>(<span>node_names, zip, temp_dir)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="tests.test_support_bundle.create_failed_support_bundles"><code class="name flex">
<span>def <span class="ident">create_failed_support_bundles</span></span>(<span>client, apps_api, number=1)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="tests.test_support_bundle.test_support_bundle_agent_with_node_selector"><code class="name flex">
<span>def <span class="ident">test_support_bundle_agent_with_node_selector</span></span>(<span>client, core_api, request)</span>
</code></dt>
<dd>
<div class="desc"><p>Scenario: support bundle agent should respect node selector</p>
<p>Issue: <a href="https://github.com/longhorn/longhorn/issues/5614">https://github.com/longhorn/longhorn/issues/5614</a></p>
<p>Given there are some nodes labeled
And "system-managed-components-node-selector" is set with node label</p>
<p>When a support bundle is generated</p>
<p>Then should be able to download the support bundle successfully
And support bundle should include only the labeled nodes in node collection</p></div>
</dd>
<dt id="tests.test_support_bundle.test_support_bundle_agent_with_taint_toleration"><code class="name flex">
<span>def <span class="ident">test_support_bundle_agent_with_taint_toleration</span></span>(<span>client, taint_nodes_exclude_self)</span>
</code></dt>
<dd>
<div class="desc"><p>Scenario: support bundle agent should respect taint toleration</p>
<p>Issue: <a href="https://github.com/longhorn/longhorn/issues/5614">https://github.com/longhorn/longhorn/issues/5614</a></p>
<p>Given there are some tainted nodes in the cluster
And Longhorn tolerates the tainted nodes with setting "taint-toleration"</p>
<p>When a support bundle is generated</p>
<p>Then should be able to download the support bundle successfully
And support bundle should include all tainted nodes in node collection</p></div>
</dd>
<dt id="tests.test_support_bundle.test_support_bundle_failed_limit"><code class="name flex">
<span>def <span class="ident">test_support_bundle_failed_limit</span></span>(<span>client, apps_api)</span>
</code></dt>
<dd>
<div class="desc"><p>Scenario: test support bundle failed limit</p>
<p>Issue: <a href="https://github.com/longhorn/longhorn/issues/2759">https://github.com/longhorn/longhorn/issues/2759</a></p>
<p>Given support-bundle-failed-history-limit setting is 2
And 2 failed support bundle created</p>
<p>When create support bundle
Then should fail to create</p></div>
</dd>
<dt id="tests.test_support_bundle.test_support_bundle_purge"><code class="name flex">
<span>def <span class="ident">test_support_bundle_purge</span></span>(<span>client, apps_api)</span>
</code></dt>
<dd>
<div class="desc"><p>Scenario: test support bundle</p>
<p>Issue: <a href="https://github.com/longhorn/longhorn/issues/2759">https://github.com/longhorn/longhorn/issues/2759</a></p>
<p>Given support-bundle-failed-history-limit setting is 2
And 2 failed support bundle created</p>
<p>When set support-bundle-failed-history-limit setting to 0
Then failed support bundles should be deleted
And support bundle managers should be deleted</p>
<p>When create a failed support bundle
Then failed support bundle should be deleted
And support bundle manager should be deleted</p></div>
</dd>
<dt id="tests.test_support_bundle.test_support_bundle_should_delete_after_download"><code class="name flex">
<span>def <span class="ident">test_support_bundle_should_delete_after_download</span></span>(<span>client)</span>
</code></dt>
<dd>
<div class="desc"><p>Scenario: test support bundle should delete after download</p>
<p>Issue: <a href="https://github.com/longhorn/longhorn/issues/2759">https://github.com/longhorn/longhorn/issues/2759</a></p>
<p>Given support bundle created
And support bundle is in ReadyToDownload state</p>
<p>When download support bundle
Then support bundle is downloaded
And support bundle should be deleted
And support bundle manager should be deleted</p></div>
</dd>
<dt id="tests.test_support_bundle.test_support_bundle_should_error_when_failed"><code class="name flex">
<span>def <span class="ident">test_support_bundle_should_error_when_failed</span></span>(<span>client, apps_api)</span>
</code></dt>
<dd>
<div class="desc"><p>Scenario: test support bundle should error when failed</p>
<p>Issue: <a href="https://github.com/longhorn/longhorn/issues/2759">https://github.com/longhorn/longhorn/issues/2759</a></p>
<p>Given support-bundle-failed-history-limit setting is 1
And support bundle created
And support bundle is in Generating state</p>
<p>When delete support bundle manager deployment
Then support bundle should be in state Error</p></div>
</dd>
<dt id="tests.test_support_bundle.test_support_bundle_should_not_timeout"><code class="name flex">
<span>def <span class="ident">test_support_bundle_should_not_timeout</span></span>(<span>client, core_api)</span>
</code></dt>
<dd>
<div class="desc"><p>Scenario: test support bundle should not timeout</p>
<p>Issue: <a href="https://github.com/longhorn/longhorn/issues/6256">https://github.com/longhorn/longhorn/issues/6256</a></p>
<p>Given support bundle created
And support bundle state is (ReadyForDownload)
And replace support bundle zip file with a large file (5GB)
And support bundle file size is updated to the size of the large file</p>
<p>When download support bundle</p>
<p>Then support bundle should be downloaded successfully
And support bundle should be deleted
And support bundle manager should be deleted</p></div>
</dd>
<dt id="tests.test_support_bundle.test_support_bundle_should_replace_existing_ready_support_bundle"><code class="name flex">
<span>def <span class="ident">test_support_bundle_should_replace_existing_ready_support_bundle</span></span>(<span>client)</span>
</code></dt>
<dd>
<div class="desc"><p>Scenario: test support bundle should replace existing ready support bundle</p>
<p>Issue: <a href="https://github.com/longhorn/longhorn/issues/5882">https://github.com/longhorn/longhorn/issues/5882</a></p>
<p>Given support bundle created
And support bundle is in ReadyToDownload state
And support bundle is not downloaded</p>
<p>When new support bundle created</p>
<p>Then download new support bundle
And new support bundle is downloaded
And new support bundle should be deleted
And old support bundle should be deleted
And new support bundle manager should be deleted
And old support bundle manager should be deleted</p></div>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="tests" href="index.html">tests</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="tests.test_support_bundle.check_bundled_nodes_matches" href="#tests.test_support_bundle.check_bundled_nodes_matches">check_bundled_nodes_matches</a></code></li>
<li><code><a title="tests.test_support_bundle.create_failed_support_bundles" href="#tests.test_support_bundle.create_failed_support_bundles">create_failed_support_bundles</a></code></li>
<li><code><a title="tests.test_support_bundle.test_support_bundle_agent_with_node_selector" href="#tests.test_support_bundle.test_support_bundle_agent_with_node_selector">test_support_bundle_agent_with_node_selector</a></code></li>
<li><code><a title="tests.test_support_bundle.test_support_bundle_agent_with_taint_toleration" href="#tests.test_support_bundle.test_support_bundle_agent_with_taint_toleration">test_support_bundle_agent_with_taint_toleration</a></code></li>
<li><code><a title="tests.test_support_bundle.test_support_bundle_failed_limit" href="#tests.test_support_bundle.test_support_bundle_failed_limit">test_support_bundle_failed_limit</a></code></li>
<li><code><a title="tests.test_support_bundle.test_support_bundle_purge" href="#tests.test_support_bundle.test_support_bundle_purge">test_support_bundle_purge</a></code></li>
<li><code><a title="tests.test_support_bundle.test_support_bundle_should_delete_after_download" href="#tests.test_support_bundle.test_support_bundle_should_delete_after_download">test_support_bundle_should_delete_after_download</a></code></li>
<li><code><a title="tests.test_support_bundle.test_support_bundle_should_error_when_failed" href="#tests.test_support_bundle.test_support_bundle_should_error_when_failed">test_support_bundle_should_error_when_failed</a></code></li>
<li><code><a title="tests.test_support_bundle.test_support_bundle_should_not_timeout" href="#tests.test_support_bundle.test_support_bundle_should_not_timeout">test_support_bundle_should_not_timeout</a></code></li>
<li><code><a title="tests.test_support_bundle.test_support_bundle_should_replace_existing_ready_support_bundle" href="#tests.test_support_bundle.test_support_bundle_should_replace_existing_ready_support_bundle">test_support_bundle_should_replace_existing_ready_support_bundle</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.0</a>.</p>
</footer>
</body>
</html>
